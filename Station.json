{"extVersion":"1.2.1","name":"Station","icon":"riGlobalLine","table":[{"name":"download-date","type":"string","id":"download-date"}],"version":"1.2.1","drawflow":"{\"drawflow\":{\"Home\":{\"data\":{\"bfafd4db-17d4-49ca-9810-2fe453c5533b\":{\"name\":\"trigger\",\"description\":\"Block where workflow will start executing\",\"icon\":\"riFlashlightLine\",\"component\":\"BlockBasic\",\"editComponent\":\"EditTrigger\",\"category\":\"general\",\"inputs\":{},\"docs\":true,\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"120537ee-4124-4f72-8fbf-89e6a8659c3c\",\"output\":\"input_1\"}]}},\"allowedInputs\":true,\"maxConnection\":1,\"data\":{\"description\":\"\",\"type\":\"manual\",\"interval\":60,\"delay\":5,\"date\":\"\",\"time\":\"00:00\",\"url\":\"\",\"shortcut\":\"\",\"activeInInput\":false,\"isUrlRegex\":false,\"days\":[]},\"id\":\"bfafd4db-17d4-49ca-9810-2fe453c5533b\",\"class\":\"trigger\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"pos_x\":50,\"pos_y\":300},\"686fc8dd-65ed-4e3e-8756-a886207502b9\":{\"name\":\"new-tab\",\"description\":\"Create a new tab\",\"icon\":\"riGlobalLine\",\"component\":\"BlockBasic\",\"editComponent\":\"EditNewTab\",\"category\":\"browser\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"120537ee-4124-4f72-8fbf-89e6a8659c3c\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"bb868b59-9ffc-459d-a1e5-a21d7cb2eca5\",\"output\":\"input_1\"}]}},\"allowedInputs\":true,\"maxConnection\":1,\"data\":{\"description\":\"站点页面\",\"url\":\"{{loopData@ZtV1a6.url}}\",\"active\":true,\"inGroup\":false,\"updatePrevTab\":false},\"id\":\"686fc8dd-65ed-4e3e-8756-a886207502b9\",\"class\":\"new-tab\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"pos_x\":276,\"pos_y\":340},\"120537ee-4124-4f72-8fbf-89e6a8659c3c\":{\"id\":\"120537ee-4124-4f72-8fbf-89e6a8659c3c\",\"name\":\"loop-data\",\"data\":{\"loopId\":\"ZtV1a6\",\"maxLoop\":3,\"fromNumber\":1,\"toNumber\":10,\"loopData\":\"[\\n    {\\n        \\\"name\\\": \\\"United States\\\",\\n        \\\"id\\\": \\\"ATVPDKIKX0DER\\\",\\n        \\\"url\\\": \\\"https://sellercentral.amazon.com/home?mons_sel_dir_mcid=amzn1.merchant.d.AAZV6B7APP5ZUJTUGAIWULIOLBKA&mons_sel_mkid=ATVPDKIKX0DER&mons_sel_dir_paid=amzn1.pa.d.ACQTGY4EYNV2N2PXLYOX7DKFJSRQ\\\"\\n    },\\n    {\\n        \\\"name\\\": \\\"Mexico\\\",\\n        \\\"id\\\": \\\"A1AM78C64UM0Y8\\\",\\n        \\\"url\\\": \\\"https://sellercentral.amazon.com/home?mons_sel_dir_mcid=amzn1.merchant.d.AAZV6B7APP5ZUJTUGAIWULIOLBKA&mons_sel_mkid=A1AM78C64UM0Y8&mons_sel_dir_paid=amzn1.pa.d.ACQTGY4EYNV2N2PXLYOX7DKFJSRQ\\\"\\n    },\\n    {\\n        \\\"name\\\": \\\"Canada\\\",\\n        \\\"id\\\": \\\"A2EUQ1WTGCTBG2\\\",\\n        \\\"url\\\": \\\"https://sellercentral.amazon.com/home?mons_sel_dir_mcid=amzn1.merchant.d.AAZV6B7APP5ZUJTUGAIWULIOLBKA&mons_sel_mkid=A2EUQ1WTGCTBG2&mons_sel_dir_paid=amzn1.pa.d.ACQTGY4EYNV2N2PXLYOX7DKFJSRQ\\\"\\n    }\\n]\",\"description\":\"\",\"variableName\":\"\",\"referenceKey\":\"\",\"elementSelector\":\"\",\"specificRowAndCol\":false,\"loopThrough\":\"custom-data\"},\"class\":\"loop-data\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"bfafd4db-17d4-49ca-9810-2fe453c5533b\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"686fc8dd-65ed-4e3e-8756-a886207502b9\",\"output\":\"input_1\"}]}},\"pos_x\":539,\"pos_y\":206},\"dfa4ce9a-1403-49eb-8b27-7c0a2b4f67ed\":{\"id\":\"dfa4ce9a-1403-49eb-8b27-7c0a2b4f67ed\",\"name\":\"trigger-event\",\"data\":{\"description\":\"进入报表下载页面\",\"findBy\":\"cssSelector\",\"waitForSelector\":false,\"waitSelectorTimeout\":5000,\"selector\":\"#sc-navtab-reports li:nth-child(4) > a\",\"markEl\":true,\"multiple\":false,\"eventName\":\"click\",\"eventType\":\"mouse-event\",\"eventParams\":{\"bubbles\":true,\"cancelable\":true}},\"class\":\"trigger-event\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"bb868b59-9ffc-459d-a1e5-a21d7cb2eca5\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"f55b5a3e-cfab-4908-b898-cdddc7c586c3\",\"output\":\"input_1\"}]}},\"pos_x\":87,\"pos_y\":485},\"bb868b59-9ffc-459d-a1e5-a21d7cb2eca5\":{\"id\":\"bb868b59-9ffc-459d-a1e5-a21d7cb2eca5\",\"name\":\"event-click\",\"data\":{\"description\":\"打开菜单栏找到报表下载入口\",\"findBy\":\"cssSelector\",\"waitForSelector\":false,\"waitSelectorTimeout\":5000,\"selector\":\"#sc-navtab-reports > .sc-menu-trigger\",\"markEl\":true,\"multiple\":false},\"class\":\"event-click\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"686fc8dd-65ed-4e3e-8756-a886207502b9\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"dfa4ce9a-1403-49eb-8b27-7c0a2b4f67ed\",\"output\":\"input_1\"}]}},\"pos_x\":816,\"pos_y\":263},\"d592b2af-8131-48a4-888e-e9f1b8cf1ef3\":{\"id\":\"d592b2af-8131-48a4-888e-e9f1b8cf1ef3\",\"name\":\"trigger-event\",\"data\":{\"description\":\"点击左侧菜单栏进入下载页\",\"findBy\":\"cssSelector\",\"waitForSelector\":false,\"waitSelectorTimeout\":5000,\"selector\":\".css-1saypfi:nth-child(10) a\",\"markEl\":true,\"multiple\":false,\"eventName\":\"click\",\"eventType\":\"mouse-event\",\"eventParams\":{\"bubbles\":true,\"cancelable\":true,\"altKey\":false,\"button\":0,\"clientX\":0,\"clientY\":0,\"ctrlKey\":false,\"metaKey\":false,\"shiftKey\":false,\"movementX\":0,\"movementY\":0,\"offsetX\":0,\"offsetY\":0,\"pageX\":0,\"pageY\":0,\"screenX\":0,\"screenY\":0}},\"class\":\"trigger-event\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"f55b5a3e-cfab-4908-b898-cdddc7c586c3\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"d85ed750-cb38-477d-8b68-9a75ee00d5f5\",\"output\":\"input_1\"}]}},\"pos_x\":947,\"pos_y\":455},\"f55b5a3e-cfab-4908-b898-cdddc7c586c3\":{\"id\":\"f55b5a3e-cfab-4908-b898-cdddc7c586c3\",\"name\":\"delay\",\"data\":{\"time\":1200},\"class\":\"delay\",\"html\":\"BlockDelay\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"dfa4ce9a-1403-49eb-8b27-7c0a2b4f67ed\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"d592b2af-8131-48a4-888e-e9f1b8cf1ef3\",\"output\":\"input_1\"}]}},\"pos_x\":556,\"pos_y\":424},\"d85ed750-cb38-477d-8b68-9a75ee00d5f5\":{\"id\":\"d85ed750-cb38-477d-8b68-9a75ee00d5f5\",\"name\":\"delay\",\"data\":{\"time\":500},\"class\":\"delay\",\"html\":\"BlockDelay\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"d592b2af-8131-48a4-888e-e9f1b8cf1ef3\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"755e422e-59a7-43ea-85d7-1914314e84ca\",\"output\":\"input_1\"}]}},\"pos_x\":564,\"pos_y\":557},\"755e422e-59a7-43ea-85d7-1914314e84ca\":{\"id\":\"755e422e-59a7-43ea-85d7-1914314e84ca\",\"name\":\"javascript-code\",\"data\":{\"description\":\"时间选择赋值\",\"timeout\":2000,\"code\":\"document.querySelectorAll('.css-jfggi0')[0].shadowRoot.querySelectorAll('.input')[0].value = document.querySelectorAll('.css-jfggi0')[1].shadowRoot.querySelectorAll('.input')[0].value\\nvar el = document.querySelectorAll('.css-jfggi0')[0].shadowRoot.querySelectorAll('.input')[0];\\nvar date = document.querySelectorAll('.css-jfggi0')[1].shadowRoot.querySelectorAll('.input')[0].value;\\nel.dispatchEvent(new Event('change', { bubbles: true, composed: true }));\\nconsole.log('选择时间区间', automaRefData('dataColumns'));\\nautomaNextBlock({'download-date':date.replace(/\\\\//g, '-')})\",\"preloadScripts\":[]},\"class\":\"javascript-code\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"d85ed750-cb38-477d-8b68-9a75ee00d5f5\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"2231e784-5894-492a-b087-5fdf1f3bd05a\",\"output\":\"input_1\"}]}},\"pos_x\":151,\"pos_y\":708},\"2231e784-5894-492a-b087-5fdf1f3bd05a\":{\"id\":\"2231e784-5894-492a-b087-5fdf1f3bd05a\",\"name\":\"delay\",\"data\":{\"time\":600},\"class\":\"delay\",\"html\":\"BlockDelay\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"755e422e-59a7-43ea-85d7-1914314e84ca\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"379d4ec3-9195-4282-8b46-d98cdd7b2cad\",\"output\":\"input_1\"}]}},\"pos_x\":550,\"pos_y\":691},\"379d4ec3-9195-4282-8b46-d98cdd7b2cad\":{\"id\":\"379d4ec3-9195-4282-8b46-d98cdd7b2cad\",\"name\":\"trigger-event\",\"data\":{\"description\":\"下载报表按钮\",\"findBy\":\"cssSelector\",\"waitForSelector\":false,\"waitSelectorTimeout\":5000,\"selector\":\"kat-button\",\"markEl\":true,\"multiple\":false,\"eventName\":\"click\",\"eventType\":\"mouse-event\",\"eventParams\":{\"bubbles\":true,\"cancelable\":true}},\"class\":\"trigger-event\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"2231e784-5894-492a-b087-5fdf1f3bd05a\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"1c4c8dc6-9536-4856-91f6-c952f78d3bf4\",\"output\":\"input_1\"}]}},\"pos_x\":969,\"pos_y\":640},\"1c4c8dc6-9536-4856-91f6-c952f78d3bf4\":{\"id\":\"1c4c8dc6-9536-4856-91f6-c952f78d3bf4\",\"name\":\"delay\",\"data\":{\"time\":2000},\"class\":\"delay\",\"html\":\"BlockDelay\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"379d4ec3-9195-4282-8b46-d98cdd7b2cad\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"2f06c6c9-17c4-4e20-80db-136b76cbd0e6\",\"output\":\"input_1\"}]}},\"pos_x\":553,\"pos_y\":814},\"8d673a86-0482-45e2-b41a-fe3cf4207236\":{\"id\":\"8d673a86-0482-45e2-b41a-fe3cf4207236\",\"name\":\"loop-breakpoint\",\"data\":{\"loopId\":\"ZtV1a6\"},\"class\":\"loop-breakpoint\",\"html\":\"BlockLoopBreakpoint\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"fa3d4ecb-db74-48ad-b0ca-491ca5f0bdde\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[]}},\"pos_x\":529,\"pos_y\":1070},\"2f06c6c9-17c4-4e20-80db-136b76cbd0e6\":{\"id\":\"2f06c6c9-17c4-4e20-80db-136b76cbd0e6\",\"name\":\"javascript-code\",\"data\":{\"description\":\"发起obs上传通知\",\"timeout\":20000,\"code\":\"const corsOptions = {\\n    origin: ['https://sellercentral.amazon.com', 'sellercentral.amazon.com'],\\n    credentials: true,\\n    \\\"force new connection\\\" : true,\\n    \\\"reconnectionAttempts\\\": \\\"Infinity\\\", \\n    \\\"timeout\\\" : 10000,                  \\n    \\\"transports\\\" : [\\\"websocket\\\"]\\n}\\nlet loopData = automaRefData('loopData')['ZtV1a6']\\nlet dataColumns = automaRefData('dataColumns')[0]\\n\\n// socket监听广播\\nvar socket = io('http://localhost:9090', corsOptions); // TIP: io() 不带参数会开启自动发现\\nsocket.on('connect', function () { // TIP: 你也可以直接监听具体事件，而不用监听 `connect` 事件！\\n  console.log('下载报表');\\n  console.log(1,loopData )\\n  let str = loopData['name'] + '--' + dataColumns['download-date'] + '--' + new Date().getTime()\\n  console.log(2, str)\\n  socket.emit('ferret', str, function (data) {\\n    // 回调将在服务器端调用 cb() 后执行\\n    console.log(data); // data 将会是 'woot'\\n    if(data) {\\n      dataColumns = null;\\n      socket.emit(\\\"close\\\", {});\\n    }\\n  });\\n});\\nautomaNextBlock()\",\"preloadScripts\":[{\"src\":\"https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js\",\"removeAfterExec\":true}]},\"class\":\"javascript-code\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"1c4c8dc6-9536-4856-91f6-c952f78d3bf4\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"fbf742f1-ee1d-440f-ae4c-a16b8f68cb1e\",\"output\":\"input_1\"}]}},\"pos_x\":994,\"pos_y\":838},\"fa3d4ecb-db74-48ad-b0ca-491ca5f0bdde\":{\"id\":\"fa3d4ecb-db74-48ad-b0ca-491ca5f0bdde\",\"name\":\"close-tab\",\"data\":{\"url\":\"\",\"description\":\"\",\"activeTab\":true,\"closeType\":\"tab\",\"allWindows\":false},\"class\":\"close-tab\",\"html\":\"BlockBasic\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"fbf742f1-ee1d-440f-ae4c-a16b8f68cb1e\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"8d673a86-0482-45e2-b41a-fe3cf4207236\",\"output\":\"input_1\"}]}},\"pos_x\":182,\"pos_y\":1003},\"fbf742f1-ee1d-440f-ae4c-a16b8f68cb1e\":{\"id\":\"fbf742f1-ee1d-440f-ae4c-a16b8f68cb1e\",\"name\":\"delay\",\"data\":{\"time\":2000},\"class\":\"delay\",\"html\":\"BlockDelay\",\"typenode\":\"vue\",\"inputs\":{\"input_1\":{\"connections\":[{\"node\":\"2f06c6c9-17c4-4e20-80db-136b76cbd0e6\",\"input\":\"output_1\"}]}},\"outputs\":{\"output_1\":{\"connections\":[{\"node\":\"fa3d4ecb-db74-48ad-b0ca-491ca5f0bdde\",\"output\":\"input_1\"}]}},\"pos_x\":502,\"pos_y\":944}}}}}","settings":{"blockDelay":0,"onError":"stop-workflow","saveLog":true,"timeout":120000},"globalData":"[{ \"key\": \"value\" }]","description":"Amazon: the second step","includedWorkflows":{}}